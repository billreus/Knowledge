<!-- TOC -->

- [Linux 基本操作](#linux-基本操作)
    - [1.Linux 用户管理](#1linux-用户管理)
        - [1.1 查看用户](#11-查看用户)
        - [1.2 创建用户](#12-创建用户)
            - [1.2.1 su](#121-su)
            - [1.2.2 su-](#122-su-)
            - [1.2.3 sudo](#123-sudo)
        - [1.3 用户组](#13-用户组)
        - [1.4 删除用户](#14-删除用户)
    - [2.Linux 文件权限](#2linux-文件权限)
        - [2.1 目录](#21-目录)
        - [2.2 文件相关操作命令](#22-文件相关操作命令)
            - [ls](#ls)
            - [cd](#cd)
        - [2.3 查看文件权限](#23-查看文件权限)
        - [2.4 新建文件和目录](#24-新建文件和目录)
        - [2.5 删除文件和目录](#25-删除文件和目录)
        - [2.6 复制文件和目录](#26-复制文件和目录)
        - [2.7 移动文件和重命名](#27-移动文件和重命名)
        - [2.8 查看文件](#28-查看文件)
        - [2.9 变更文件所有者](#29-变更文件所有者)
        - [2.10 修改文件权限](#210-修改文件权限)
    - [3 软件安装](#3-软件安装)
        - [3.1 自动下载安装](#31-自动下载安装)
        - [3.2 deb软件包](#32-deb软件包)
        - [3.3 tar.gz安装](#33-targz安装)
        - [3.4 二进制包安装](#34-二进制包安装)
    - [4 常用快捷键与操作](#4-常用快捷键与操作)
        - [4.1 全局快捷键](#41-全局快捷键)
        - [4.2 命令行快捷键](#42-命令行快捷键)
        - [4.3 常见命令](#43-常见命令)
            - [4.3.1 求助](#431-求助)
                - [1. --help](#1---help)
                - [2. man](#2-man)
                - [3. info](#3-info)
            - [4.3.2 关机](#432-关机)
                - [1. who](#1-who)
                - [2. sync](#2-sync)
                - [3. shutdown](#3-shutdown)
    - [5 环境变量](#5-环境变量)
        - [5.1 定义](#51-定义)
        - [5.2 时效性](#52-时效性)
        - [5.3 路径](#53-路径)
    - [6 文件](#6-文件)
        - [6.1 搜索](#61-搜索)
        - [6.2 文件打包压缩](#62-文件打包压缩)
            - [6.2.1 zip压缩打包](#621-zip压缩打包)
            - [6.2.2 tar打包](#622-tar打包)
            - [6.2.3 磁盘信息](#623-磁盘信息)
    - [7 计划任务](#7-计划任务)
        - [7.1 crontab使用](#71-crontab使用)
    - [8 命令顺序执行与管道](#8-命令顺序执行与管道)
        - [8.1 顺序执行多条](#81-顺序执行多条)
        - [8.2 有选择的执行命令](#82-有选择的执行命令)
        - [8.3 管道](#83-管道)
            - [8.3.1 一般使用](#831-一般使用)
            - [8.3.2 grep正则查找](#832-grep正则查找)
            - [8.3.3 sort排序](#833-sort排序)
    - [9 数据流重定向](#9-数据流重定向)
        - [9.1 简单的重定向](#91-简单的重定向)
    - [10 正则表达式](#10-正则表达式)
    - [11 进程](#11-进程)
        - [11.1 后台](#111-后台)
        - [11.2 进程](#112-进程)
    - [12 日志](#12-日志)
    - [13 VIM](#13-vim)

<!-- /TOC -->

# Linux 基本操作

## 1.Linux 用户管理

### 1.1 查看用户

查看当前登陆用户的用户名`whoami`

### 1.2 创建用户

创建用户的命令：`sudo adduser user`

切换用户：`su -l user`

#### 1.2.1 su

`su <user>`可以切换到用户user，执行需要输入用户密码。

#### 1.2.2 su-

`sudo <cmd>`可以以root级别运行cmd命令，需要当前用户属于sudo组并且需要输入当前密码

#### 1.2.3 sudo

`su - <user>`用于切换用户，同时环境变量也会改变成目标用户的环境变量

### 1.3 用户组

查找用户组下的成员：`groups user`

查看用户是否有root权限：`sudo ls`

将其它用户加入sudo用户组：`sudo usermod -G sudo user`

### 1.4 删除用户

`sudo deluser user --remove-home`

## 2.Linux 文件权限

### 2.1 目录

最底层根目录为：/

之后分为十六层，分别为：

bin：启动时用到的一些命令

boot：开机相关文件

dev：设备文件

etc：存放不同运行等级的启动脚本的链接文件

home：用户目录

lib：存放程序动态库和模块文件

media：挂载本地磁盘等本地存储设备

mnt：挂着其它临时文件

opt：系统自带一些软件包的安装目录

root：root用户

sbin：系统更新备份等命令

srv：服务进程所需的数据文件

tmp：临时文件

usr：所有系统默认软件会安装到这个目录

1.bin(非必要可执行文件) 2.include(头文件) 3.lib 4.local(本地数据) 5.share 6.sbin 7.src(源代码)

var:变量文件，存放系统或程序运行过程中的数据文件。

可分享不可改变：/usr（软件存放）/opt（第三方软件）

可分享可改变：/var/mail（用户邮箱） /var/news（新闻组）

不可分享不可改变：/etc（配置文件）/boot（开机及内核）

不可分享可改变：/var/run（程序相关） /var/lock（文件锁相关）

### 2.2 文件相关操作命令

#### ls

ls 命令是 list 的缩写。ls 用来打印出当前目录的清单，可以查看文件权限(包括目录、文件夹、文件权限)查看目录信息等。

`ls [选项] [目录名]`

常用参数：

* -a：列出所有文件，包括以 . 开头的隐含文件
* -l：列出文件的权限、所有者、文件大小等信息
* -d：将目录象文件一样显示
* -h：列出文件大小
* -t：以文件修改时间排序

#### cd

`cd /` 从当前目录进入

`cd ..`从当前进入父目录

`cd ~`从当前进入用户主目录

`cd -`从当前进入上次目录

### 2.3 查看文件权限

使用命令`ls`可以查看文件，使用较长格式列出文件：`ls -l`

例如：`drwxr-xr-x 2 shiyan shiyanuser 4096 11月 13 15:27 Documents`

每段表示一个内容，分别为：

文件类型和权限，链接数，所有者，所属用户组，文件大小，最后修改时间，文件名

对于文件的权限分为:

```linux
'r'表示允许读权限
'w'表示允许写权限
'x'表示允许执行权限
```

上文中`drwxr-xr-x`中rwx为拥有者权限，r-x为所属用户组权限，r-x为其它用户权限

文件类型可分为：

```linux
'd',目录
'l',软链接
'b',块设备
'c',字符设备
's',socket
'p',管道
'-',普通文件
```

`ls -A`显示所有文件包括隐藏文件（Linux下以.开头的文件为隐藏文件）

`ls -dl <目录名>`查看某个目录的完整属性

`ls -AsSh` 显示所有文件大小

### 2.4 新建文件和目录

`touch filename`新建空白文件

`mkdir name`新建名为name的空目录

`mkdir -p fathe/son/sons`新建多级目录

### 2.5 删除文件和目录

`rm filename`删除文件

`rm -f filename`强制删除

`rm -r father`删除目录

### 2.6 复制文件和目录

`cp filename /home/father/son/grandson`复制文件

`cp -r father family`复制目录

### 2.7 移动文件和重命名

`mv file1 filetest`将文件 file1 移动到 filetest 目录

`mv file1 file2`将文件 file1 重命名为 file2

### 2.8 查看文件

`cat` 和 `tac` 用来打印文件内容到标准输出（终端），其中 `cat` 为正序显示，`tac` 为倒序显示。

### 2.9 变更文件所有者

`ls filename`可以查看到文件的所有者

首先打开到该文件目录下,再变更文件所有者，`sudo chown user1 user2`即可把文件所有者从2变成1。

### 2.10 修改文件权限

每个文件有三组权限：拥有者，所属用户，其他用户

`g`、`o`、`u`分别表示group、others、user。+和-分别表示增加和去掉相应权限。

例如文件权限修改为只有我自己可以用`chmod go-rw filename`即可。

## 3 软件安装

### 3.1 自动下载安装

`sudo apt-get install 软件名`

会自动下载软件包到 /var/cache/apt/archives 目录下并安装。

`sudo apt-get upgrade`升级本地可更新全部软件

`sudo apt-get remove name`删除已安装软件包,但不包含软件包的配置文件

`sudo apt-get purge`完全删除

`sudo apt-get clean`移除已安装软件包

`sudo apt-get autoclean`移除已安装的软件旧版

### 3.2 deb软件包

`sudo dpkg -i name`安装软件包

### 3.3 tar.gz安装

1. 打开到需要安装的目录

2. 解压压缩包到指定目录`sudo tar-xvzf xxxxx.tar.gz-c /usr/local(目录)`

3. 对解压完成的压缩包重命名`sudo mv xxx1 xxxxx`

4. 给定权限`sudo chown -R 组群：用户名`

### 3.4 二进制包安装

将从网络上下载的二进制包解压后放到合适的目录，然后将包含可执行的主程序文件的目录添加进PATH环境变量即可

## 4 常用快捷键与操作

### 4.1 全局快捷键

`ctrl+alt+D`|显示桌面 / 还原显示

`ctrl+alt+T`|启动终端

`ctrl+alt+L`|锁屏 / 显示登录对话框

`ctrl+alt+F1-F6`|进入 1-6 命令行环境

`ctrl+alt+F7`|进入图形界面环境

`alt+Tab`|在当前桌面的窗口间顺序切换

`alt+F10`|最大化/取消最大化窗口

`alt+F9`|最小化窗口

`alt+F1`|下拉应用程序菜单

`alt+F2`|打开运行应用程序的窗口

`ctrl+Q`|关闭应用程序窗口

### 4.2 命令行快捷键

`Tab`|命令补全

`Ctrl+c`|强行终止当前程序（不会退出终端）

`Ctrl+d`|键盘输入结束或退出终端

`Ctrl+s`|暂停当前程序，暂停后按下任意键恢复运行

`Ctrl+z`|将当前程序放到后台运行，恢复到前台为命令fg

`Ctrl+a`|将光标移至输入行头，相当于Home键

`Ctrl+e`|将光标移至输入行末，相当于End键

`Ctrl+k`|删除从光标所在位置到行末

`Alt+Backspace`|向前删除一个单词

`Shift+PgUp`|将终端显示向上滚动

`Shift+PgDn`|将终端显示向下滚动

### 4.3 常见命令

#### 4.3.1 求助

##### 1. --help

指令基本用法的介绍

##### 2. man

man是manual的缩写，将指令的具体信息显示出来

##### 3. info

info与man相似，但info将文档分成一个个页面，每个页面可以跳转

#### 4.3.2 关机

##### 1. who

在关机前使用查看是否有其它用户在线

##### 2. sync

为了加快对磁盘文件的读写速度，位于内存中的文件数据不会立即同步到磁盘上，因此关机之前需要先进行 sync 同步操作

##### 3. shutdown

```shell
# shutdown [-krhc] 时间 [信息]
-k ： 不会关机，只是发送警告信息，通知所有在线的用户
-r ： 将系统的服务停掉后就重新启动
-h ： 将系统的服务停掉后就立即关机
-c ： 取消已经在进行的 shutdown 指令内容
```

## 5 环境变量

### 5.1 定义 

在UNIX系统中每个进程都有各种的环境变量设置，当一个进程被创建，处理创建过程中的明确指定，它将继承其父进程的绝大部分环境设置。

环境变量分为三种：

1. 当前shell进程私有用户自定义变量
2. shell自身变量
3. 自定义环境变量

对应三种命令：set,env,export.

### 5.2 时效性

永久性：需要修改配置文件，变量永久生效。

临时性：使用export命令声明，关闭后失效。

在每个用户目录下面有个隐藏文件.profile只对当前用户永久生效。而写在/etc/profile里面是对所有用户永久生效。

### 5.3 路径

查看环境变量`echo $PATH`

其中路径以：作为分隔符。

## 6 文件

### 6.1 搜索

常用的命令有`whereis`,`which`,`find`,`locate`。

* 简单快速whereis
* 文件搜索，可以使用正则表达式locate
* 指令搜索which
* 精而细find

### 6.2 文件打包压缩

压缩主要有zip,tar,7z

#### 6.2.1 zip压缩打包

打包 ：`zip something.zip something` （something如果是目录zip后面加 -r 参数）

解包：`unzip something.zip`

指定路径：-d 参数

#### 6.2.2 tar打包

打包：`tar -cf something.tar something`

解包：`tar -xf something.tar`

指定路径：-C 参数

#### 6.2.3 磁盘信息

查看磁盘容量：`df -h`

查看1级目录信息：`du -h -d 0 ~` (二级只需要把0改成1)

## 7 计划任务

crontab用于设置周期性被执行的指令。

### 7.1 crontab使用

添加计划任务`crontab -e`

在文档中编辑需要的任务,每个用户使用 crontab -e 添加计划任务，都会在 /var/spool/cron/crontabs 中添加一个该用户自己的任务文档。

删除计划任务`crontab -r`

查询任务`crotab -l`

如果是系统级别的定时任务，只需要以sudo权限编辑/etc/crontab

## 8 命令顺序执行与管道

### 8.1 顺序执行多条

多条顺序执行可以使用`;`来实现

### 8.2 有选择的执行命令

如果我们在让它自动顺序执行命令时，前面的命令执行不成功，而后面的命令又依赖于上一条命令的结果，那么就会造成花了时间，最终却得到一个错误的结果

`which cowsay>/dev/null && cowsay -f head-in ohch~`如果前面的命令执行结果（不是表示终端输出的内容，而是表示命令执行状态的结果）返回0则执行后面的，否则不执行，你可以从环境变量获取上一次命令的返回结果。

### 8.3 管道

管道是一种通信机制，通常用于进程间的通信，它表现出来的形式就是将前面每一个进程的输出(stdout)直接作为下一个进程的输入(stdin)。

#### 8.3.1 一般使用

比如查看/etc目录下有哪些文件和目录使用`ls -al /etc`

由于内容比较多想滚动使用可以使用管道`ls -al /etc | less`

#### 8.3.2 grep正则查找

命令一般形式：`grep [命令选项] 用于匹配的表达式文件`

例如:`grep -rnI "name"`即可搜索目录下的name的文本文件，并显示行号

-r 参数表示递归搜索子目录中的文件,-n表示打印匹配项行号，-I表示忽略二进制文件。

使用管道查看环境变量:`export | grep ".*name$"`

#### 8.3.3 sort排序

输入按照一定方式排序，然后再输出,它支持的排序有按字典排序,数字排序，按月份排序，随机排序，反转排序，指定特定字段进行排序等等。

`cat /etc/passwd | sort` 字典排序

`cat /etc/passwd | sort -r` 反转排序

## 9 数据流重定向

将标准输出导向一个文件或最佳到一个文件中就是重定向。

### 9.1 简单的重定向

Linux默认提供三个特殊设备用于终端显示和输出，分别为stdin（标准输入,对应于你在终端的输入），stdout（标准输出，对应于终端的输出），stderr（标准错误输出，对应于终端的输出）。

## 10 正则表达式

选择：`a|b`竖直分隔符表示选择,既可以匹配a也可以匹配b

数量限定：

* `+`表示前面字符必须出现至少一次
* `?`表示前面字符最多出现一次
* `*`表示前面字符可以不出现，也可以出现一次或多次

范围和优先级：`()`圆括号可以用来定义模式字符串的范围和优先级，这可以简单的理解为是否将括号内的模式串作为一个整体。例如，"gr(a|e)y"等价于"gray|grey"，（这里体现了优先级，竖直分隔符用于选择a或者e而不是gra和ey），"(grand)?father"匹配father和grandfather（这里体验了范围，?将圆括号内容作为一个整体匹配）。

语法和优先级可以使用时查阅文档

## 11 进程

`ps －fxo user,ppid,pid,pgid,command`其中pid 就是该进程的一个唯一编号，ppid 就是该进程的父进程的 pid，command 表示的是该进程通过执行什么样的命令或者脚本而产生的

每一个进程都是一个进程组的成员，而且这个进程组是唯一的，他们是依靠 PGID来区别的，而每当一个进程被创建的时候，它便会成为其父进程所在组中的一员。

一般情况，进程组的 PGID 等同于进程组的第一个成员的 PID，并且这样的进程称为该进程组的领导者,也就是领导进程，进程一般通过使用 `getpgrp()` 系统调用来寻找其所在组的 PGID，领导进程可以先终结，此时进程组依然存在，并持有相同的PGID，直到进程组中最后一个进程终结。

### 11.1 后台

可以通过`&`符号让命令在后台运行

在输入运行后，会显示[1] 234等数字，其中[1]表示job的编号，后面数字是进程的PID,最后显示Done表示该命令在后台执行完毕

使用`ctrl + z`可以使当前工作停止并丢入后台

后台的进程可以使用`jobs`来实现查询

使用`fg %job的编号`实现把后台的进程拿到前台，对应的放入后台并运行`bg %job的编号`

停止进程`kill -signal %jobnumber`其中signal有64个信号方式，可以用kill -l查阅。常用有-1(restart)-2(ctrl+c)-9(强制停止)-15(停止))

### 11.2 进程

`top`可以查阅系统运行的一些信息

`ps -l`查看自己的进程

`ps aux`和`ps axjf`可以显示进程运行时的信息，axjf是以树状显示

`pstree`可以直接看到树状进程

可以把ps和grep配合使用查找单独进程`ps aux | grep xxxx`

`netstat -ap | grep port`查看特定端口的进程

## 12 日志

日志一般存放在/var/log目录中，可以使用`ll /var/log`查看日志

## 13 VIM

vim共有三个模式

* 一般指令模式（Command mode）：VIM 的默认模式，可以用于移动游标查看内容；
* 编辑模式（Insert mode）：按下 "i" 等按键之后进入，可以对文本进行编辑；
* 指令列模式（Bottom-line mode）：按下 ":" 按键之后进入，用于保存退出等操作。

常用指令模式的命令：

`:w`写入磁盘

`:w!`强制写入磁盘

`:q`离开

`:q!`强制离开不保存

`:wq`写入磁盘后离开

`wq!`强制写入后离开